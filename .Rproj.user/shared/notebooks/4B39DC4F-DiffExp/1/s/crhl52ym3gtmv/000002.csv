"0","# Turn into a list and split the list into components for each cluster and transform, so rows are genes and columns are samples and make rownames as the sample IDs"
"0","pb <- split.data.frame(pb, "
"0","                       factor(splitf)) %>%"
"0","  lapply(function(u) "
"0","    set_colnames(t(u), "
"0","                 stringr::str_extract(rownames(u), ""(?<=_)[:alnum:]+"")))"
"0",""
"0","class(pb)"
"1","[1]"
"1"," ""list"""
"1","
"
"0","# Explore the different components of list"
"0","str(pb)"
"1","List"
"1",""
"1"," of "
"1",""
"1","5"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Basal    "
"1",""
"1",":"
"1","Formal class"
"1",""
"1"," '"
"1",""
"1","dgCMatrix"
"1",""
"1","' [package """
"1",""
"1","Matrix"
"1",""
"1","""] with "
"1",""
"1","6 slots"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","i       "
"1",""
"1",":"
"1"," int [1:158316] "
"1",""
"1","0 2 4 5 6 7 8 9 10 11"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","p       "
"1",""
"1",":"
"1"," int [1:10] "
"1",""
"1","0 17867 35342 53327 70646 88452 107210 123809 139841 158316"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dim     "
"1",""
"1",":"
"1"," int [1:2] "
"1",""
"1","21054 9"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dimnames"
"1",""
"1",":"
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:21054] "
"1",""
"1","""AL627309.1"" ""AL627309.3"" ""AL627309.5"" ""AL627309.4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:9] "
"1",""
"1","""ana1"" ""ana2"" ""ana3"" ""ana4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","x       "
"1",""
"1",":"
"1"," num [1:158316] "
"1",""
"1","1 1 33 1 50 1 4 3 1 16"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","factors "
"1",""
"1",":"
"1"," "
"1",""
"1","list()
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Ciliated "
"1",""
"1",":"
"1","Formal class"
"1",""
"1"," '"
"1",""
"1","dgCMatrix"
"1",""
"1","' [package """
"1",""
"1","Matrix"
"1",""
"1","""] with "
"1",""
"1","6 slots"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","i       "
"1",""
"1",":"
"1"," int [1:162566] "
"1",""
"1","2 4 6 7 8 9 10 11 12 13"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","p       "
"1",""
"1",":"
"1"," int [1:10] "
"1",""
"1","0 17574 35924 53442 71107 89045 108166 126316 143389 162566"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dim     "
"1",""
"1",":"
"1"," int [1:2] "
"1",""
"1","21054 9"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dimnames"
"1",""
"1",":"
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:21054] "
"1",""
"1","""AL627309.1"" ""AL627309.3"" ""AL627309.5"" ""AL627309.4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:9] "
"1",""
"1","""ana1"" ""ana2"" ""ana3"" ""ana4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","x       "
"1",""
"1",":"
"1"," num [1:162566] "
"1",""
"1","2 20 43 1 2 1 1 5 73 5"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","factors "
"1",""
"1",":"
"1"," "
"1",""
"1","list()
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Ionocytes"
"1",""
"1",":"
"1","Formal class"
"1",""
"1"," '"
"1",""
"1","dgCMatrix"
"1",""
"1","' [package """
"1",""
"1","Matrix"
"1",""
"1","""] with "
"1",""
"1","6 slots"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","i       "
"1",""
"1",":"
"1"," int [1:68105] "
"1",""
"1","18 19 20 21 23 27 28 31 34 36"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","p       "
"1",""
"1",":"
"1"," int [1:10] "
"1",""
"1","0 7670 15953 24745 30861 39428 48778 54419 60619 68105"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dim     "
"1",""
"1",":"
"1"," int [1:2] "
"1",""
"1","21054 9"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dimnames"
"1",""
"1",":"
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:21054] "
"1",""
"1","""AL627309.1"" ""AL627309.3"" ""AL627309.5"" ""AL627309.4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:9] "
"1",""
"1","""ana1"" ""ana2"" ""ana3"" ""ana4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","x       "
"1",""
"1",":"
"1"," num [1:68105] "
"1",""
"1","19 2 1 1 1 2 2 1 1 2"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","factors "
"1",""
"1",":"
"1"," "
"1",""
"1","list()
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Secretory"
"1",""
"1",":"
"1","Formal class"
"1",""
"1"," '"
"1",""
"1","dgCMatrix"
"1",""
"1","' [package """
"1",""
"1","Matrix"
"1",""
"1","""] with "
"1",""
"1","6 slots"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","i       "
"1",""
"1",":"
"1"," int [1:162778] "
"1",""
"1","0 2 4 6 7 8 9 10 11 12"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","p       "
"1",""
"1",":"
"1"," int [1:10] "
"1",""
"1","0 18322 36212 54306 71954 90365 108929 126908 143799 162778"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dim     "
"1",""
"1",":"
"1"," int [1:2] "
"1",""
"1","21054 9"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dimnames"
"1",""
"1",":"
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:21054] "
"1",""
"1","""AL627309.1"" ""AL627309.3"" ""AL627309.5"" ""AL627309.4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:9] "
"1",""
"1","""ana1"" ""ana2"" ""ana3"" ""ana4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","x       "
"1",""
"1",":"
"1"," num [1:162778] "
"1",""
"1","5 6 61 61 5 14 4 3 11 198"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","factors "
"1",""
"1",":"
"1"," "
"1",""
"1","list()
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Unknown  "
"1",""
"1",":"
"1","Formal class"
"1",""
"1"," '"
"1",""
"1","dgCMatrix"
"1",""
"1","' [package """
"1",""
"1","Matrix"
"1",""
"1","""] with "
"1",""
"1","6 slots"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","i       "
"1",""
"1",":"
"1"," int [1:161467] "
"1",""
"1","0 1 2 3 4 6 7 8 9 10"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","p       "
"1",""
"1",":"
"1"," int [1:10] "
"1",""
"1","0 18464 36645 54659 71549 89340 107578 125414 142118 161467"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dim     "
"1",""
"1",":"
"1"," int [1:2] "
"1",""
"1","21054 9"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","Dimnames"
"1",""
"1",":"
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:21054] "
"1",""
"1","""AL627309.1"" ""AL627309.3"" ""AL627309.5"" ""AL627309.4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:9] "
"1",""
"1","""ana1"" ""ana2"" ""ana3"" ""ana4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","x       "
"1",""
"1",":"
"1"," num [1:161467] "
"1",""
"1","1 1 7 2 64 54 9 11 4 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","@ "
"1",""
"1","factors "
"1",""
"1",":"
"1"," "
"1",""
"1","list()
"
