"0","# Aggregate the counts per sample_id and cluster_id"
"0",""
"0","# Subset metadata to only include the cluster and sample IDs to aggregate across"
"0","groups <- colData(sce)[, c(""cluster_id"", ""sample"")]"
"0",""
"0","# Aggregate across cluster-sample groups"
"0","pb <- aggregate.Matrix(t(counts(sce)), "
"0","                       groupings = groups, fun = ""sum"") "
"0",""
"0","class(pb)"
"1","[1]"
"1"," ""dgCMatrix"""
"1","
"
"1","attr(,""package"")"
"1","
"
"1","[1]"
"1"," ""Matrix"""
"1","
"
"0","dim(pb)"
"1","[1]"
"1","    45"
"1"," 21054"
"1","
"
"0","pb[1:6, 1:6] "
"1","6 x 6 sparse Matrix of class ""dgCMatrix""
"
"1","              "
"1"," AL627309.1"
"1"," AL627309.3"
"1"," AL627309.5"
"1"," AL627309.4"
"1"," LINC01409"
"1"," FAM87B"
"1","
Unknown_ana1  "
"1","          1"
"1","          1"
"1","          7"
"1","          2"
"1","        64"
"1","      ."
"1","
Secretory_ana1"
"1","          5"
"1","          ."
"1","          6"
"1","          ."
"1","        61"
"1","      ."
"1","
Basal_ana1    "
"1","          1"
"1","          ."
"1","          1"
"1","          ."
"1","        33"
"1","      1"
"1","
Ciliated_ana1 "
"1","          ."
"1","          ."
"1","          2"
"1","          ."
"1","        20"
"1","      ."
"1","
Ionocytes_ana1"
"1","          ."
"1","          ."
"1","          ."
"1","          ."
"1","         ."
"1","      ."
"1","
Unknown_ana2  "
"1","          1"
"1","          ."
"1","          5"
"1","          1"
"1","        39"
"1","      ."
"1","
"
