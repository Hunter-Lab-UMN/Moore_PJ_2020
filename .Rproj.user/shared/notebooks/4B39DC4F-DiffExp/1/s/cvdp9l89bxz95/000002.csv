"0","# Generate sample level metadata"
"0",""
"0","## Determine the number of cells per sample"
"0","table(sce$sample)"
"1","
"
"1"," ana1 "
"1"," ana2 "
"1"," ana3 "
"1"," ana4 "
"1"," ana5 "
"1"," ana6 "
"1","fuso1 "
"1","fuso2 "
"1","fuso3 "
"1","
"
"1"," 1145 "
"1","  829 "
"1","  931 "
"1"," 1330 "
"1"," 1133 "
"1"," 1613 "
"1"," 1320 "
"1"," 1027 "
"1"," 2663 "
"1","
"
"0","## Turn named vector into a numeric vector of number of cells per sample"
"0","n_cells <- as.numeric(table(sce$sample))"
"0",""
"0","## Determine how to reorder the samples (rows) of the metadata to match the order of sample names in sids vector"
"0","m <- match(sids, sce$sample)"
"0",""
"0","## Create the sample level metadata by combining the reordered metadata with the number of cells corresponding to each sample."
"0","ei <- data.frame(colData(sce)[m, ], "
"0","                 n_cells, row.names = NULL) %>% "
"0","  select(-""cluster_id"")"
"0","ei"
